-- Banco Meet - Script de creaci√≥n + datos iniciales
-- Base de datos: PostgreSQL 15+
-- Ejecutar completo en pgAdmin

Tabla persona

CREATE TABLE public.persona (
    id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre character varying(100) NOT NULL,
    genero character varying(20) NOT NULL,
    edad integer NOT NULL,
    identificacion character varying(13) NOT NULL UNIQUE,
    direccion character varying(255),
    telefono character varying(255)
);

Tabla cliente (hereda de persona)

CREATE TABLE public.cliente (
    id bigint PRIMARY KEY REFERENCES public.persona(id),
    cliente_id character varying(255) NOT NULL UNIQUE,
    contrasena character varying(255) NOT NULL,
    estado boolean NOT NULL DEFAULT true
);

Tabla cuenta

CREATE TABLE public.cuenta (
    id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    numero_cuenta character varying(255) NOT NULL UNIQUE,
    tipo_cuenta character varying(255) NOT NULL CHECK (tipo_cuenta IN ('Ahorros', 'Corriente')),
    saldo_inicial numeric(38,2) NOT NULL DEFAULT 0,
    estado boolean NOT NULL DEFAULT true,
    cliente_id bigint NOT NULL REFERENCES public.cliente(id)
);

Tabla movimiento

CREATE TABLE public.movimiento (
    id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    fecha timestamp without time zone NOT NULL DEFAULT now(),
    tipo_movimiento character varying(255) NOT NULL,
    valor numeric(38,2) NOT NULL,
    saldo_anterior numeric(38,2) NOT NULL,
    saldo numeric(38,2) NOT NULL,
    cuenta_id bigint NOT NULL REFERENCES public.cuenta(id)
);

-Datos iniciales

INSERT INTO public.persona (id, nombre, genero, edad, identificacion, direccion, telefono) VALUES
(35, 'Jose Lema',        'Masculino', 35, '1718635214', 'Otavalo sn y Principal',    '098254785'),
(36, 'Marianela Montalvo','Masculino', 25, '1715458254', 'Amazonas y NNUU',           '097548965'),
(37, 'Juan Osorio',       'Masculino', 35, '1718547085', '13 de junio y Equinoxial',  '098874587'),
(38, 'Anderson Chanchay', 'Masculino', 35, '1719638064', 'Nayon, Quito, Ecuador',     '0984018228');

INSERT INTO public.cliente (id, cliente_id, contrasena, estado) VALUES
(35, '41982528',  '$2a$10$/58WzmtlW1NTM3RpWFFLfurcQQir9PBUaKfV2LH5v6RGGZpYXyGLG', true),
(36, '101705994', '$2a$10$eU6FaNnHqFdvtlFHqDWVJOEZCUjn3bQSnvzJ/AJgSyiOvDOQzBH4.', true),
(37, '157189720', '$2a$10$7RiwMgohegfvqaDwGNwklebQVSQDGjIM5mF0KoOSXycG5mnWdGMLy', true),
(38, '619740363', '$2a$10$FVVnmodtbxPlJyzk0QIJz.oNQ2xogwXRI7RTSFklDLuOKyKHbUbMe', true);

INSERT INTO public.cuenta (id, numero_cuenta, tipo_cuenta, saldo_inicial, estado, cliente_id) VALUES
(20, '9583150989', 'Corriente', 1000.00, true, 35),
(16, '7724237139', 'Ahorros',   1425.00, true, 35),
(17, '1551232214', 'Corriente',  700.00, true, 36),
(18, '8879359943', 'Ahorros',    150.00, true, 37),
(19, '1040727531', 'Ahorros',      0.00, true, 36),
(21, '6352955478', 'Ahorros',   1000.00, true, 38);

INSERT INTO public.movimiento (id, fecha, tipo_movimiento, valor, saldo_anterior, saldo, cuenta_id) VALUES
(19, '2026-02-07 01:40:01', 'Retiro de 575',   -575.00, 2000.00, 1425.00, 16),
(20, '2026-02-07 01:41:15', 'Deposito de 600',  600.00,  100.00,  700.00, 17),
(21, '2026-02-07 01:42:17', 'Deposito de 150',  150.00,    0.00,  150.00, 18),
(22, '2026-02-07 01:43:24', 'Retiro de 540',   -540.00,  540.00,    0.00, 19),
(23, '2026-02-07 03:07:44', 'Retiro de 1000', -1000.00, 2000.00, 1000.00, 21);